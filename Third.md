#游戏设计中经典的计算公式（连载）
##第三节——ELO等级分体系
经过上两节的介绍，相信大家对游戏设计中Ehp和Edps有一定的了解了。本节我们来研究一下ELO等级分体系，等级分体系是根据它的推广者埃洛(elo) 名字命名的，它是一种以数值表示的体系将等级差别转化为分数或取胜概率。是不是一下子就联想到DOTA和LOL的匹配和天梯系统，是不是觉得每次在游戏中查看双方的胜率感觉神奇的接近。不用惊讶，其实这类系统广泛运用在棋牌比赛、游戏竞技等领域。
****
即使粗略看比赛成绩表，也能够看出选手的表现是有起伏的，也就是 有“状态”之分。强手未必恒定表现好于弱手；每人之状态在不同的日子 不同的比赛里都会有好坏不同，要发现其中的规律，必需要建立在样本足够大的情况下。总的来说整个生涯里每一点上，一名选手的表现将大致围绕在某个平均水平上下波动， 有时会有背离， 而出现大背离的情况比出现小背离的情况频率要低。

###等级量表

由此我们可得出ELO 体系的第一个假定，用标准统计术语表述就是：可以建立这么一个等级量表(rating scale)，某个体在这个表里的不同表现将正常分布。 第二个假定牵涉到了等级量表区间间隔的定义。简单地说，在某一个特定的实力范畴里，尽管可能存在实力上的差异，但总的来说可以预期没有谁比谁好或差很多。 由此可以定量划分区间。

等级量表(rating scale) ELO 体系使用一个叫“区间尺度”(interval scale)的定义，即等级差别是可能性方面的唯 一重要因素。有学者理解这是指对阵双方谁有多大机会胜/负/和，唯一影响因素在于他 们之间的等级差别，这样既排除了难以确定的“状态好坏”(第一假定：个人的总体表现大致是正 常分布的)，也排除了具体谁对谁的影响(第二假定：某一特定实力范畴里，相互之间的差别一般 可预期不会出现太大意外)。因此即使出现“爆冷”或“克星”，也视为偶发情况，因为 ELO 体系是建立在样本足够大量的统计基础上的。而且个体的等级也是动态反映的。

###标准分类间隔
 有一个概念叫“标准分类间隔”(class interval)， 简单说就是某一个等级里最高与最低之 间的差别。在国际象棋里，FIDE(即国际棋联)采用每 200 分为一个间隔的分类法，并且给每一个 间隔取一个名字或排名以更好分辨。 FIDE 的等级分分隔表中，将 1700 分选择作为普通水平业余棋手的实力值，将 2000 分选择作为区分大师与业余者之间的分界线。详细的可见下图

![](http://imgsrc.baidu.com/forum/pic/item/400638c79f3df8dcf028d522cd11728b461028b0.jpg)

以上是国际棋联给出的等级量表，可以看到跟天梯给出的分数水平对应区间是基本一样的。可以说天梯的计分段等级系统是国际象棋排名等级系统在dota和LOL中的利用，例如LOl中的排位的战区系统，如下图：
![](http://b175.photo.store.qq.com/psb?/V1000cAq0rKbWf/zKboEsdBH7Mf5cQ.Cqw9Xl9EASX5WkAmPzWce46tg1Y!/b/dGAiW2jnGgAA&bo=ZgMgAgAAAAABAGA!&rf=viewer_4)

从上图不难看出该战区玩家的水平是非常接近的，如果处于该战区的玩家不提升自身的技术水平的话就很难再向上爬升了，说来三刀哥就很惭愧了，在此战区逗留了很长时间了。但从侧面不得不承认这种分类法增加了游戏的可玩性和合理性。

###常态分布函数
我们知道，强手未必总是胜过弱手，于是就使用一个“常态分布函数”(Normal Distribution Function)来代表一名棋手的波动表现，这是统计学上的概念。从这个函数里可以得出另一个函数叫“常态概率函数”(normal probability function )，这个就定义了根据比赛对抗结果可得出的等级差别，或者根据已知的等级差别可得出的预期比赛对抗结果。它是这样的：

![](http://imgsrc.baidu.com/forum/pic/item/393e93529822720e9298b8497bcb0a46f31fab7c.jpg)

P(D)这个值，就是以等级分差别D为自变量计算出来的预期取胜可能性(预期得分率)，它可近似用下面这个公式来计算:

![](http://imgsrc.baidu.com/forum/pic/item/9bd1942bd40735faa7a9140a9e510fb30e240874.jpg)

于是我们可以把典型数值事先都计算出来编成一张表，到时要计算等级分变化时只需查表找出对应数字就是。它叫“百分比预期值表”(Percentage Expectancy Table)，简称PE表。下面就是两个PE表，表一从得分率P得出等级分差异D(P)；表二则反过来，从等级分差异Rtg Dif得出预期得分率。可见这两个表是基于同一个公式即“常态概率函数”计算出来的，只不过方向相反，实质一样。所以可以套公式计算，也可以查表直接得出数字。

![](http://imgsrc.baidu.com/forum/pic/item/7cc16d061d950a7b828214770ad162d9f3d3c913.jpg)

![](http://imgsrc.baidu.com/forum/pic/item/c8d08518367adab4276641f08bd4b31c8601e41c.jpg)

以上的公式以及表格给出了在面对不同对手时系统或者该等级制度对于你取得的结果的预期。由于国际象棋中只有胜负和三种情况，分别得1、0.5、0分，因而可以更为简洁的理解ELO。举例来说：一个等级分1950的棋手，她的对手等级分1700分，那么她取胜的机会有多大呢？
等级分差别D=1950-1700=250，代入上面那么近似计算公式，就是：

![](http://b175.photo.store.qq.com/psb?/V1000cAq0rKbWf/VumRmsNPZ5YAZCB2O1iMVu6qbAEyW7qDt.LQ8h.3I4w!/b/dMiaWWi*GgAA&bo=dgFSAAAAAAABAAI!&rf=viewer_4)

也就是说，她全取1分的机会有80.8%，大约是81%。事实上，查表2，可得知等级分差别在246-256之间的强手预期取胜可能性就是81%。不用计算，查表即可。

如果将两名棋手换成两只LOL队伍，也就不难理解排位系统是如何在该队伍面对不同对手时给出的不同预期了。

###ELO重要公式
####表现等级分/预计等级分公式：
1. ELO体系的第一个公式：Rp = Rc + D(P) (1) <br>
    其中：Rp是表现等级分；Rc是(平均)竞赛/对手等级分。如对手不止一个，那就要计算平均对手等级分。D(P)就是以百分比数值P为自变量所得出的等级分差别(这个数字可以从表1中查出来)
，这个公式既可用于定期计算等级分，也可以临时计算。它可用于决定第一次参加与有等级分的对手角逐的棋手的初始等级分。
　　
2. 第二个公式：Rn = Ro + K * (W - We) (2) <br>
      其中：Rn是赛事后的新等级分；Ro是赛事前的原等级分；K是单局得分的等级分点值，它是一个系数，取值有约定的；W是实际对局得分(胜得1、和得0.5)；We是在原等级分基础上的预期对局得分。
　　这个公式是用来在连续基础上(也就是每局或每个赛事之后)计算新等级分的。它把最新的表现调整考虑进先前的等级分中。它的逻辑意义是一个棋手的表现高于他的预期得分以及低于他的预期失分。
     

###总结
ELo等级分体系是一个很重要的知识点，特别在竞技类游戏风靡全球的当下。本节的知识点有点儿多，希望大家能够耐心地阅读，我毕竟能力有限，只为大家列举了一些，有什么疑问或补充欢迎提出，三刀哥是一个虚心的骚年，他也是需要进步的。

（泰然网原创，欢迎转载，转载须注明来源网站及作者，三刀哥镇贴）

![](http://pic40.nipic.com/20140412/6540589_104118404136_2.jpg)








